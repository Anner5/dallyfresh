{% extends 'df_goods/base.html' %}
{% block goods %}
		<div class="r_wrap fr clearfix">
			<div class="sort_bar">
			
				<a href="/list{{typeinfo.id|default:'0'}}_{{pindex}}_1/?switch={{switch}}" {% if sort < 2 %}class="active"{% endif%}>默认</a>
				<a href="/list{{typeinfo.id|default:'0'}}_{{pindex}}_2/?switch={{switch}}" {% if sort == 2 %}class="active"{% endif%}>价格</a>
				<a href="/list{{typeinfo.id|default:'0'}}_{{pindex}}_3/?switch={{switch}}" {% if sort == 3 %}class="active"{% endif%}>人气</a>
			</div>
			
			<ul class="goods_type_list clearfix">
			{% for t in page %}
				<li class="test">
					<a href="/{{t.gtype_id}}_{{t.id}}/"><img src="/static/df_goods/goods{{t.gpic}}.jpg"></a>
					<h4><a href="/{{t.gtype_id}}_{{t.id}}/">{{t.gtitle}}</a></h4>
					<div class="operate">
						<span class="prize">￥{{t.gprice}}</span>
						<span class="unit">{{t.gprice}}/{{t.gunit}}}</span>
						<a href="javascript:" class="add_goods" title="加入购物车"></a>
					</div>
				</li>
				{% endfor %}
			</ul>

			<!-- 分页 -->
			<div class="pagenation">
			{{page.len}}
			{% if page.has_previous %}
				<a href="/list{{typeinfo.id|default:'0'}}_{{page.previous_page_number}}_{{sort}}"><上一页</a>
			{% endif %}

			{% for index in paginator.page_range %}
			{% if index == page.number %}
				<a href="#" class="active">{{pindex}}</a>			
			{% else %}
				<a href="/list{{typeinfo.id|default:'0'}}_{{index}}_{{sort}}/">{{index}}</a>
			{% endif %}
			{% endfor %}

			{% if page.has_next %}
				<a href="/list{{typeinfo.id|default:'0'}}_{{page.next_page_number}}_{{sort}}">>下一页</a>
			{% endif %}

			</div>
		</div>
	</div>
{% endblock goods %}
{% block footJs %}
<script type="text/javascript">

	$('.goods_type_list').delegate('.add_goods','click',function(){
		var $a = $(this).parent('div').prev().html();
		var href = $a.match(/_(\d+)\//)[1];
		$.get('/user/add'+href+'_1/',function(data){
			$('#show_count').html(parseInt(data['count']));
		})
	})
</script>
{% endblock footJs %}	
